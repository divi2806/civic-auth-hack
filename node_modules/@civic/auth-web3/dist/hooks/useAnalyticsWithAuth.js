import { useEffect } from "react";
import { useToken } from "@civic/auth/react";
import { analyticsEmitter } from "../lib/analytics/index.js";
/**
 * Hook to configure the analytics emitter with the user's authentication token.
 * This ensures all analytics events include the JWT for authentication with the proxy.
 */
export const useAnalyticsWithAuth = () => {
    const { idToken } = useToken();
    useEffect(() => {
        // Set up a JWT provider function that will return the current idToken
        // Convert null to undefined since our function expects string | undefined
        analyticsEmitter.setJwtProvider(() => {
            if (!idToken) {
                // Using console.log for consistency with AnalyticsEmitter
                console.log("Analytics: No ID token available");
                return undefined;
            }
            return idToken;
        });
    }, [idToken]);
};
//# sourceMappingURL=useAnalyticsWithAuth.js.map